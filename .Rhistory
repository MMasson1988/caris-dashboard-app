suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
enrole <- read_excel("enrole.xlsx", sheet = 1)
library(ggplot2)
library(viridis)
library(dplyr)
plot_beneficiaries_by_categorie <- function(df, lo_department, set_title, set_xlabel, set_ylabel) {
# Agréger les données
sorted_df <- df %>%
group_by(.data[[lo_department]]) %>%
summarise(count = n()) %>%
arrange(desc(count))
total_active_patients <- sum(sorted_df$count)
# Création du graphique sans lignes de grille
ggplot(sorted_df, aes(x = reorder(.data[[lo_department]], count), y = count, fill = count)) +
geom_col() +
coord_flip() +
geom_text(aes(label = count), hjust = -0.1, size = 4.5) +
scale_fill_viridis(option = "viridis", direction = -1, discrete = FALSE) +
labs(
title = paste0(set_title, "\nTotal bénéficiaires : ", total_active_patients),
x = set_ylabel,
y = set_xlabel,
fill = NULL
) +
theme_minimal(base_size = 14) +
theme(
panel.grid.major = element_blank(),  # Supprime les lignes majeures
panel.grid.minor = element_blank(),  # Supprime les lignes mineures
plot.title = element_text(size = 16, face = "bold"),
axis.text = element_text(face = "bold"),
legend.position = "none"
)
}
# plot
enrole <- read_excel("enrole.xlsx", sheet = 1)
reticulate::repl_python()
enrole <- read_excel("enrole.xlsx", sheet = 1)
reticulate::repl_python()
enrole <- read_excel("enrole.xlsx", sheet = 1)
reticulate::repl_python()
enrole <- read_excel("enrole.xlsx", sheet = 1)
reticulate::repl_python()
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing
rnut_sans_testing <- py$nut_sans_testing
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing
rnut_sans_testing <- py$nut_sans_testing
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing
reticulate::repl_python()
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing
rnut_sans_testing <- py$nut_sans_testing[[
"caseid", "first_name", "last_name", "name", "age_in_year", "dob","gender","commune","office"]]
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing[[
"caseid", "first_name", "last_name", "name", "age_in_year", "dob","gender","commune","office"]]
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing[[
"caseid", "first_name", "last_name", "name", "age_in_year", "dob","gender","commune","office"]]
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_testing <- py$nut_sans_testing[[
"caseid", "first_name", "last_name", "name", "age_in_year", "dob","gender","commune","office"]]
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_comptage <- py$nut_sans_comptage
DT::datatable(
nut_sans_comptage,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = DT::JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3E4827', 'color': '#fff'});",
"}"
),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 6
)
)
rnut_sans_comptage <- py$nut_sans_comptage
DT::datatable(
rnut_sans_comptage,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = DT::JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3E4827', 'color': '#fff'});",
"}"
),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 6
)
)
rnut_sans_testing <- py$nut_sans_testing[[
"caseid", "first_name", "last_name", "name", "age_in_year", "dob","gender","commune","office"]]
rnut_sans_testing <- py$nut_sans_testing
DT::datatable(
rnut_sans_testing,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = DT::JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3E4827', 'color': '#fff'});",
"}"
),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 6
)
)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
rnut_sans_comptage <- py$nut_sans_comptage
DT::datatable(
rnut_sans_comptage,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = DT::JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3E4827', 'color': '#fff'});",
"}"
),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 6
)
)
rnut_sans_testing <- py$nut_sans_testing
DT::datatable(
rnut_sans_testing,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = DT::JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3E4827', 'color': '#fff'});",
"}"
),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 6
)
)
setwd("C:/Users/moise/Downloads/caris-dashboard-app")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggiraphExtra))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
reticulate::use_python("C:/Users/moise/AppData/Local/Programs/Python/Python313/python.exe")
#use_virtualenv("./../../python_env", required = TRUE)
reticulate::repl_python()
ptme_enceinte <- read_excel("ptme_enceinte.xlsx", sheet = 1)
reticulate::repl_python()
rptme_enceinte<-py$ptme_enceinte
DT::datatable(
rptme_enceinte,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#800000', 'color': '#fff'});",
"}"),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 3
),
callback = JS("
table.rows().every(function(rowIdx, tableLoop, rowLoop) {
$(this.node()).css({'font-size': '16px', 'height': '20px'});
});
")
)
delinquency <- read_excel("delinquency.xlsx", sheet = 1)
DT::datatable(
delinquency,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#800000', 'color': '#fff'});",
"}"),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 3
),
callback = JS("
table.rows().every(function(rowIdx, tableLoop, rowLoop) {
$(this.node()).css({'font-size': '16px', 'height': '20px'});
});
")
)
reticulate::repl_python()
# Conversion explicite des objets Python en data.frame R
df_tx_curr <- py$ptme_enceinte %>% as.data.frame()
df_club <- py$ptme_in_club %>% as.data.frame()
df_non_club <- py$fe_non_club %>% as.data.frame()
DT::datatable(
df_non_club,
extensions = 'Buttons',
filter = 'bottom',
options = list(
dom = 'Bfrtip',
columnDefs = list(list(className = 'dt-center', targets = "_all")),
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#800000', 'color': '#fff'});",
"}"),
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
pageLength = 3
),
callback = JS("
table.rows().every(function(rowIdx, tableLoop, rowLoop) {
$(this.node()).css({'font-size': '16px', 'height': '20px'});
});
")
)
reticulate::repl_python()
